<!DOCTYPE html>
<html>
<head>
    <title><%=title%></title>

    <meta charset=utf-8 />
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />

    <link rel="stylesheet" href="/bootstrap/tagsinput/bootstrap-tagsinput.css">
    <link rel="stylesheet" href="/bootstrap/css/bootstrap.css">
    <link rel="stylesheet" href="/bootstrap/css/bootstrap-responsive.css">
    <link href='//api.tiles.mapbox.com/mapbox.js/v1.5.2/mapbox.css' rel='stylesheet' />


    <script src="/bootstrap/js/jquery.js"></script>
    <script src="/bootstrap/js/bootstrap.js"></script>
    <script src='//api.tiles.mapbox.com/mapbox.js/v1.5.2/mapbox.js'></script>
    <script src="/bootstrap/tagsinput/bootstrap-tagsinput.min.js"></script>
    <script src="/bootstrap/tagsinput/bootstrap-tagsinput-angular.js/"></script>


    <link rel="stylesheet" href="/jquery-ui/css/ui-lightness/jquery-ui-1.10.3.custom.min.css">
    <script src="/jquery-ui/js/jquery-1.9.1.js"></script>
    <script src="/jquery-ui/js/jquery-ui-1.10.3.custom.min.js"></script>

    <script src="/bootstrap/js/typeahead.js"></script>
    <script src="/bootstrap/js/hogan-2.0.0.js"></script>

    <style>
        #map{
            height: 400px;
        }
        body {
            padding-top: 60px; /* When using the navbar-top-fixed */
            padding-bottom: 150px;
        }
    </style>

    <style>
        .column { width: 100%; float: right; padding-bottom: 100px; }
        .portlet { margin: 0px; }
        .portlet-header { margin: 0.3em; padding-bottom: 4px; padding-left: 0.2em; }
        .portlet-header .ui-icon { float: right; }
        .portlet-content { padding: 0.4em; }
        .ui-sortable-placeholder { border: 1px dotted black; visibility: visible !important; height: 50px !important; }
        .ui-sortable-placeholder * { visibility: hidden; }

        .newitem {
            border-color: #000000;
            border-style: solid;
        }

        .newitem:hover {
            background-color: #ffffff;
        }
    </style>
    <script>
        $(function() {
            $( ".column" ).sortable({
                connectWith: ".column"
            });
            $( ".column" ).disableSelection();

            var initPortlets = function(port) {
                $( ".portlet" ).addClass( "ui-widget ui-widget-content ui-helper-clearfix ui-corner-all" )
                        .find( ".portlet-header" )
                        .addClass( "ui-widget-header ui-corner-all" )
                        .prepend( "<span class='ui-icon ui-icon-minusthick'></span>")
                        .end()
                        .find( ".portlet-content" );

                $( ".portlet-header .ui-icon" ).click(function() {
                    $( this ).toggleClass( "ui-icon-minusthick" ).toggleClass( "ui-icon-plusthick" );
                    $( this ).parents( ".portlet:first" ).find( ".portlet-content" ).toggle();
                });
            }

            initPortlets();

            $(".newitem").click(function(e){
                var itemType = $(e.target).attr('type');

                var portlet =
                        '<div class="portlet ui-widget ui-widget-content ui-helper-clearfix ui-corner-all">'+
                            '<div class="portlet-header ui-widget-header ui-corner-all">'+ itemType +'</div>' +
                            '<div class="portlet-content"></div>' +
                        '</div>';

                $('.portlet').last().before(portlet);
                //initPortlets();
            });
        });
    </script>

    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-45875480-3', 'booltin.herokuapp.com');
        ga('send', 'pageview');
    </script>

    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-45875480-3']); // This is my account number, I have added the zeros in this editor
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

    <script src="/socket.io.min.js"></script>
    <script>
        var socket = io.connect('http://localhost:5001/');
        socket.on('newlog', function (data) {
            console.log(data);
        });
    </script>

    <script language="javascript">
        $(document).ready(function() {
            $("#searchInput").typeahead([{
                name: 'users',
                header: '<div style="background-color: #c4bebf;padding: 20px;"><i>Users</i></div>',
                valueKey: 'display',
                remote: '/search/users?q=%QUERY',
                template: [
                    '<div class="repo-name" style="background-color: #c4bebf;padding: 20px;">',
                    '<b>{{display}}</b><br>',
                    '<i>{{link}}</i>',
                    '</div>'
                ].join(''),
                engine: Hogan,
                limit: 5
            },{
                name: 'boards',
                header: '<div style="background-color: #c4bebf;padding: 20px;"><i>Boards</i></div>',
                valueKey: 'display',
                remote: '/search/boards?q=%QUERY',
                template: [
                    '<div class="repo-name" style="background-color: #c4bebf;padding: 20px;">',
                    '<b>{{display}}</b><br>',
                    '<i>{{link}}</i>',
                    '</div>'
                ].join(''),
                engine: Hogan,
                limit: 5
            }]);

            $('#searchInput').on('typeahead:selected', function (object, datum) {
                // Example: {type: "typeahead:selected", timeStamp: 1377890016108, jQuery203017338529066182673: true, isTrigger: 3, namespace: ""...}
                console.log(object);

                // Datum containg value, tokens, and custom properties
                // Example: {value: "@JakeHarding", tokens: ['Jake', 'Harding'], name: "Jake Harding", profileImageUrl: "https://twitter.com/JakeHaridng/profile_img"}
                console.log(datum);

                window.location = datum.link;
            });
        });

        function search()
        {
            var datastring= $("#searchform").serialize();
            $.ajax({
                url: '/search',
                type: 'get',
                dataType: 'json',
                data: datastring,
                error: function(data){
                    alert('error '+data.status);
                },
                success: function(data){
                    alert('success '+data.status);
                    $('browsers').append('<option value="coyBIT">');
                }
            });
            return false;
        }
    </script>

</head>
<body>

<nav class="navbar navbar-fixed-top navbar-inverse">
    <div class="navbar-inner">
        <div class="container">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>
            <a class="brand" href="/">Booltin</a>
            <div class="nav-collapse">
                <ul class="nav">
                    <li>
                        <a href="/" onClick="_gaq.push(['_trackEvent', 'Links', 'Click', 'Home']);">
                            <i class="icon-home icon-white"></i>Home</a>
                    </li>
                    <li>
                        <form id="searchform" class="navbar-search pull-left" method="get" action="/search" onsubmit="return search()">
                            <input type="text" class="search-query2" placeholder="for ex. coybit@gmail.com" name="query" id="searchInput"/>
                        </form>
                    </li>
                </ul>
                <ul class="nav pull-right">
                    <% if(everyauth.loggedIn){ %>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Hello <%= (everyauth.user) ? everyauth.user.email : 'dude' %> <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li><a href="/timeline">Timeline</a></li>
                            <li><a href="/profile">Profile</a></li>
                            <li><a href="/logout">Logout</a></li>
                        </ul>
                    </li>
                    <%} else {%>
                    <li class="nav">
                        <a href="/login">Login</a>
                    </li>
                    <%}%>
                </ul>
                <% if(everyauth.loggedIn){ %>
                <ul class="nav pull-right">
                    <li><a href="/board/new" class="">Create Board</a></li>
                    <li><a href="/flyer/new" class="">Create Flyer</a></li>
                </ul>
                <%}%>
            </div><!-- /.nav-collapse -->
        </div><!-- /.container -->
    </div><!-- /.navbar-inner -->
</nav><!-- /.navbar -->


<%-body %>
<div class="row">
    <span class="span6 pull-right">
    </span>
</div>

<nav class="navbar navbar-default navbar-fixed-bottom" role="navigation">
    <div style="background-color: #353535; height: 50px;color: #cccccc;">
        <div style="margin: 5px">
            Copyright Folan-Folan
        </div>
    </div>
</nav>
</body>
</html>