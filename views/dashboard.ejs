<html>
<head>
    <title>Dashboard - Booltin</title>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.js" type="text/javascript"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="/script/jquery.watable.js" type="text/javascript" charset="utf-8"></script>
    <link rel='stylesheet' href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css"/>
    <link rel='stylesheet' href='/css/watable.css'/>

    <style>
        body {
            font-size: 10px;
            background-color: #B3A389;
        }

        .container {
            background-color: #f1f1f1;
            padding: 0 2em;
        }

        .headerRow {
            margin-bottom: 5em;
        }

        .tableRow {
            margin-top: 2em;
        }

        .footerRow {
        }

        #formsTable {
            overflow: auto;
            border: 2px solid gray;
            border-radius: 4px;
        }

        .spanBox {
            display: inline;
            float: none;
            margin: 0 0.2em;
            padding: 0.3em;
            border: 1px solid rgb(179, 179, 179);
            border-radius: 5px;
            background-color: rgb(225, 225, 225);
            color: rgb(96, 96, 96);
            font-weight: 700;
        }

        .header {
            font-size: 5em;
            height: 2em;
            line-height: 2.5em;
            border-bottom: 2px solid #000;
        }

        .formName {
            font-size: 2em;
            line-height: 1.5em;
        }

        .formName select {
            width: 100%;
        }

        .footer {
            text-align: center;
            font-size: 1.2em;
            line-height: 1em;
            margin-top: 1em;
        }
    </style>

    <script>
        $(function(){
            // First fill Forms list, then fill table according to current selected form
            fillFormsList( fillTable );
        });

        function fillFormsList( callback ) {

            var ownerID = $('#ownerID').attr('val');

            $.get('/api/forms?ownerID=' + ownerID).done( function(res) {

                res.forms.forEach( function(form) {
                    var option = $('<option>').text(form.formName).attr('id',form.formID);
                    $('#formsList').append(option);
                });

                callback();
            })
        }

        function fillTable() {
            var qsParams =
                    '?ownerID=' + $('#ownerID').attr('val')  +
                    '&formID=' + $('#formsList :selected').attr('id');

            $('#formsTable').WATable({
                url: '/api/applications' + qsParams,
                preFill: true,
                pageSize: 20,
                sorting: true,
                filter: true,
                sortEmptyLast: true,
                checkboxes: true
            });
        }
    </script>
</head>
<body>
<div class="container">
    <div class="row headerRow">
        <div class="span12">
            <div class="header">
                Dashboard
            </div>
        </div>
    </div>

    <div class="row toolbarRow">
        <div class="span7">
            <input type="hidden" id="ownerID" val="<%=ownerID%>">

            <div class="formName">
                <select id="formsList"></select>
            </div>
        </div>
        <div class="span5">
            <button class="btn btn-success">New Form</button>
            <button class="btn btn-warning">Inactive Form</button>
            <button class="btn btn-danger">Delete Form</button>
            <button class="btn btn-normal">View Form</button>
        </div>
    </div>

    <div class="row tableRow">
        <div class="span12">
            <div id="formsTable"></div>
        </div>
    </div>

    <div class="row footerRow">
        <div class="span12">
            <div class="footer">
                Powered By Booltin
            </div>
        </div>
    </div>
</div>

</body>
</html>