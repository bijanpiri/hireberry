<% layout('layout') -%>


<script src="/jquery-ui/js/file_upload.js"></script>

<script src="http://cburgmer.github.io/rasterizeHTML.js/rasterizeHTML.allinone.js"></script>

<script src="/html2canvas.js"></script>
<link href="/css/flyer.css" rel="stylesheet">

<!--<link href="/css/font-awesome.css" rel="stylesheet" />-->
<link href="http://netdna.bootstrapcdn.com/font-awesome/3.0.2/css/font-awesome.css" rel="stylesheet">


<script src="/script/jquery.jcarousel.min.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script> <!-- Put Google Map just before flyer.js -->

<!--<link rel="stylesheet" href="../../bootstrap-modal/css/bootstrap-modal.css">-->
<!--<script src="http://getbootstrap.com/2.3.2/assets/js/bootstrap.js"></script>-->
<!--<script src="http://getbootstrap.com/2.3.2/assets/js/google-code-prettify/prettify.js"></script>-->
<!--<script src="../../bootstrap/js/bootstrap.min.js"></script>-->
<!--<script src="../../bootstrap-modal/js/bootstrap-modalmanager.js"></script>-->
<!--<script src="../../bootstrap-modal/js/bootstrap-modal.js"></script>-->

<!--<link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">-->
<link href="/css/job.css" rel="stylesheet">
<script src="/flyer.js"></script>
<script src="/script/jquery.hotkeys.js"></script>

<script src="/script/bootstrap-wysiwyg.js"></script>
<script>
    var flyer;
    var flyerid;
    var previewWindow = 0;

    function changeBackground() {
        $('#backgroundImage').click();
    }

    function shot(){
        var canvas = document.getElementById("canvas");
        var flyerElem = $('.portletStack');

        //rasterizeHTML.drawHTML(flyerElem,canvas);

        html2canvas(flyerElem, {
            onrendered: function(canvas) {
                console.log( canvas.toDataURL() );
            }
        });
    }

    $(function() {
        flyerid = $('input[name=flyerid]').val();
        flyer = $('.portletStack').Flyer({
            editMode:true,
            flyerid:flyerid
        });

        $('#buttonPreview').click( function() {

            var flyerid = $('input[name=flyerid]').val();

            if( previewWindow==0 )
                previewWindow = window.open('/flyer/' + flyerid);
            else
                previewWindow.location = '/flyer/' + flyerid;
        })

        $('#buttonSave').click(function(){

            $('#buttonSave').text('Saving...').addClass('disabled');

            var flyerElem = $('.portletStack');
            var flyerjson = flyer.flyer2json();

            flyer.getShot(function(image){

                flyerjson.thumbnail = image;

                $.post( '/flyer/save', {flyer:flyerjson} )
                        .done(function(data){
                            $('#buttonSave').text('Save').removeClass('disabled');
                        })
                        .fail(function(data){
                            $('#buttonSave').text('Save*').removeClass('disabled');
                        });
            });

            /*
             // Generate Thumbnail Image
             html2canvas(flyerElem, {
             onrendered: function(canvas) {
             console.log( canvas.toDataURL() );


             flyerjson.thumbnail = canvas.toDataURL();

             $.post( '/flyer/save', {flyer:flyerjson} )
             .done(function(data){
             $('#buttonSave').text('Save').removeClass('disabled');
             })
             .fail(function(data){
             $('#buttonSave').text('Save*').removeClass('disabled');
             });
             }
             });
             */
        });
        /*

         $('#backgroundImage').fileupload('option',{dropZone:undefined});

         */
        $('.portletHeader .logo').fileupload({
            url:'/flyer/upload',
            dataType: 'json',
            done: function (e, data) {
                flyer.setLogo( '/uploads/' + data.result.files[0].name , true );
            }
        });

        $('#plusButton').click(function(){
            $('#plusButton').hide();
            $('#addButtons').show();
        });

        $('.closeButton').click(function(){
            $('#plusButton').show();
            $('#addButtons').hide();
        });

        function rotate(element, degree) {
            element.animate({
                '-webkit-transform': 'rotate(' + degree + 'deg)',
                '-moz-transform': 'rotate(' + degree + 'deg)',
                '-ms-transform': 'rotate(' + degree + 'deg)',
                '-o-transform': 'rotate(' + degree + 'deg)',
                'transform': 'rotate(' + degree + 'deg)',
                'zoom': 1
            }, 5000);
        }
    });

</script>

<div class="container-fluid" style="width: 95%;">
    <div class="row-fluid" style="margin-bottom: 30px;">
        <div class="span9 offset1" style="background-color: #555; color: #fff; line-height: 25px; padding-left:10px ">
            STEP 1 > <b>STEP2. Create Your Flyer </b> > STEP3</b>
            <a href="/flyer/publish/<%=flyerid%>" class="btn btn-success pull-right">Next</a>
            <a href="/flyer/template" class="btn btn-success pull-right">Back</a>
        </div>
    </div>
    <div class="row-fluid">
        <div class="span3 offset1" style="margin-bottom: 10px;">
            <input type="hidden" name="flyerid" value="<%=flyerid%>"/>
            <input type="hidden" name="flyertext" placeholder="Enter Flyer Description" />
            <button type="button" class="btn btn-success" id="buttonSave">Save</button>
            <button type="button" class="btn btn-warning" id="buttonPreview">Preview</button>
            <span><%=templateID%></span>
        </div>
        <div class="span1 offset4">
            <button class="btn btn-warning" onclick="changeBackground()">Background</button>
            <input type="file" id="backgroundImage" hidden>
        </div>
    </div>
    <div class="row-fluid">
        <div class="span10 offset1" id="portletsBox">
            <div class="portletHeader">
                <img class="logo">
                <div class="title">
                    Title
                </div>
            </div>
            <div class="portletStack"></div>
            <div class="portletCreator container-fluid">
                <div class="row-fluid text-center" id="portletCreatorAlarm" hidden>
                    Error: There is no space for adding new portlet!
                </div>

                <div class="row-fluid" id="plusButton">
                    <div style="width: 84px; height: 64px;margin: 0 auto;">
                        <a class="buttonFrame plusButtonFrame">
                            <i class="button centeralBackgroundImage plusButton "></i>
                        </a>
                    </div>
                </div>
                <div class="row-fluid" id="addButtons" hidden>
                    <div style="margin: 0 auto;position: relative;width: 612px;">
                        <a class="newitem buttonFrame" type="1">
                            <i class="button centeralBackgroundImage addNewTextButton"></i>
                        </a>
                        <a class="newitem buttonFrame" type="2">
                            <i class="button centeralBackgroundImage addNewPhotoButton"></i>
                        </a>
                        <a class="newitem buttonFrame" type="3">
                            <i class="button centeralBackgroundImage addNewVideoButton"></i>
                        </a>
                        <a class="newitem buttonFrame">
                            <i class="button centeralBackgroundImage closeButton"></i>
                        </a>
                        <a class="newitem buttonFrame" type="7">
                            <i class="button centeralBackgroundImage addNewVoiceButton"></i>
                        </a>
                        <a class="newitem buttonFrame" type="4">
                            <i class="button centeralBackgroundImage addNewLinkButton"></i>
                        </a>
                        <a class="newitem buttonFrame" type="6">
                            <i class="button centeralBackgroundImage addNewMapButton"></i>
                        </a>
                        <a class="newitem buttonFrame" type="8">
                            WorkType
                        </a>
                        <a class="newitem buttonFrame" type="9">
                            PersonalInfo
                        </a>
                        <a class="newitem buttonFrame" type="10">
                            Resume
                        </a>
                        <a class="newitem buttonFrame" type="11">
                            Else?
                        </a>
                        <a class="newitem buttonFrame" type="12">
                            Profiles
                        </a>
                        <a class="newitem buttonFrame" type="13">
                            Seperator
                        </a>
                        <a class="newitem buttonFrame" type="14">
                            Skill
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="widgets">

    <div class="textWidget">

        <!--<div class="btn-toolbar" data-role="editor-toolbar"-->
        <!--data-target="#editor">-->
        <!--<a data-edit="bold" style="display: block;width: 100px;height: 100px; background: red">bold</a>-->
        <!--<a data-edit="fontName Arial">...</a>-->
        <!--</div>-->
        <div id="editor" class="text-widget"></div>
    </div>

    <div class="imageWidget">
        <div class="imageWidgetOuterContainer">
            <div class="imageWidgetInnerContainer">
                <input type="file" name="picture" hidden>
                <i class="imageWidgetCamera"></i>
                <div>Drop your pictures here</div>
                <div>or
                    <button class="wbtn wbtn-2 wbtn-2a browseImgBtn">Browse</button>
                    your computer
                </div>
            </div>
        </div>

    </div>

    <div class="mapWidget">
        <div id="panel" class="panel">
            <textarea id="address" placeholder="Sydney, NSW" class="address-left"></textarea>
            <div id="map-canvas" class="map-right"></div>
            <img id="map-image" hidden class="map-right">
        </div>
    </div>

    <div class="mapWidgetSetting">
        Setting
    </div>

    <div class="container-fluid workTypeWidget">
        <div class="row-fluid temp" id="workPlace-workType" >

            <div class="offset1 span5" >
                <div style="margin-bottom: 5em;">

                    <div class="radioButtonGroup">

                        <p class="radioButtonGroupDescription">3. You prefer to work at ...</p>

                        <div class="bbtn-group">
                            <input class="bbtn bbtn-radio" id="atHome" type="radio" name="workPlace" value="home" checked>
                            <label for="atHome" class="bbtn-label b-icon-container bbtn-circlular b-label-atHome">
                                <i class="b-icon b-icon-atHome" ></i>
                            </label>
                            <p class="subtitle">Home</p>
                        </div>

                        <div class="bbtn-group">
                            <input class="bbtn bbtn-radio" id="atOffice" type="radio" name="workPlace" value="office">
                            <label for="atOffice" class="bbtn-label b-icon-container bbtn-circlular b-label-atOffice">
                                <i class="b-icon b-icon-atOffice" ></i>
                            </label>
                            <p class="subtitle">Office</p>
                        </div>

                    </div>

                </div>
            </div>

            <div class="span5" >
                <div style="margin-bottom: 5em;">
                    <div class="radioButtonGroup">

                        <p class="radioButtonGroupDescription">4. You prefer to work as ...</p>

                        <div class="bbtn-group">
                            <input class="bbtn bbtn-radio" id="fullTime" type="radio" name="workTime" value="fulltime" checked>
                            <label for="fullTime" class="bbtn-label b-icon-container bbtn-circlular b-label-fullTime">
                                <i class="b-icon b-icon-fullTime" ></i>
                            </label>
                            <p class="subtitle">Full-Time</p>
                        </div>

                        <div class="bbtn-group">
                            <input class="bbtn bbtn-radio" id="partTime" type="radio" name="workTime" value="parttime">
                            <label for="partTime" class="bbtn-label b-icon-container bbtn-circlular b-label-partTime">
                                <i class="b-icon b-icon-partTime" ></i>
                            </label>
                            <p class="subtitle">Part-Time</p>
                        </div>

                    </div>
                </div>
            </div>

        </div>
    </div>

    <div class="container-fluid personalInfoWidget">
        <div class="row-fluid temp"  id="text">
            <div class="offset3 span6" >
                <div class="card">
                    <div class="cardHead">
                        <img class="profilePic" id="profileImage">
                    </div>
                    <input type="text" name="name" id="name" placeholder="Enter Your Name ..." class="cardField">
                    <hr>
                    <input type="email" name="email" id="email" placeholder="Enter Your Email Address ..." class="cardField">
                    <div class="cardFoot"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="container-fluid anythingElseWidget">
        <div class="offset1 span10" >
            <textarea placeholder="Anything else?" rows="5" class="textarea" name="anythingElse"></textarea>
        </div>
    </div>

    <div class="container-fluid resumeWidget">
        <div class="offset1 span10" >
            <div class="dropZone" id="dropzone">
                <i class="logo resumeIcon"></i>
                <span>Click Here To Add Your Résumé (Max. 5MB)</span>
            </div>
            <input type="file" id="resumefile" name="resume" style="display: none" max-size="5,242,880">
        </div>
    </div>

    <div class="container-fluid profilesWidget">
        <div class="row-fluid">
            <div class="offset3 span6" >
                <div class="profileAddress">
                    <i class="icon github-icon"></i>
                    <span>http://github.com/</span>
                    <input type="text" name="ghprofile" id="ghprofile"  placeholder="You">
                </div>
                <iframe class="ghcard" frameborder="0" scrolling="0" width="100%" height="200" allowtransparency hidden=""></iframe>
            </div>
        </div>

        <div class="row-fluid">
            <div class="offset3 span6" >
                <div class="profileAddress">
                    <i class="icon stackoverflow-icon"></i>
                    <span>http://stackoverflow.com/</span>
                    <input type="text" name="soprofile" id="soprofile"  placeholder="You">
                </div>
                <img class="soflair" hidden="">
            </div>
        </div>

        <div class="row-fluid">
            <div class="offset3 span6" >
                <div class="profileAddress">
                    <i class="icon dribbble-icon"></i>
                    <span>http://dribbble.com/</span>
                    <input type="text" name="drprofile" id="drprofile"  placeholder="You">
                </div>
            </div>
        </div>

        <div class="row-fluid">
            <div class="offset3 span6" >
                <div class="profileAddress">
                    <i class="icon behance-icon"></i>
                    <span>http://behance.net/</span>
                    <input type="text" name="beprofile" id="beprofile"  placeholder="You">
                </div>
            </div>
        </div>

        <div class="row-fluid">
            <div class="offset3 span6" >
                <div class="profileAddress">
                    <i class="icon linkedin-icon"></i>
                    <span>http://linkedin.com/in/</span>
                    <input type="text" name="liprofile" id="liprofile"  placeholder="You">
                </div>
            </div>
        </div>

        <div class="row-fluid">
            <div class="offset3 span6" >
                <div class="profileAddress">
                    <i class="icon twitter-icon"></i>
                    <span>http://twitter.com/</span>
                    <input type="text" name="twprofile" id="twprofile"  placeholder="You">
                </div>
            </div>
        </div>
    </div>

    <div class="container-fluid seperatorWidget">
        <div class="row-fluid" id="flatTitle">
            <div class="span12" >
                <div class="flatSection">
                    <hr>
                    <span>More Info</span>
                </div>
            </div>
        </div>
    </div>

    <div class="container-fluid skillWidget">
        <div class="span12" >
            <div>
                <div style="display: table;margin: 0 auto;margin-bottom: 50px;">

                    <div class="bbtn-group">
                        <input class="bbtn bbtn-radio" id='html5' type="checkbox" name="html5">
                        <label for="html5" class="bbtn-label b-icon-container b-label-html5">
                            <i class="b-icon b-icon-html5" ></i>
                        </label>
                        <p>HTML5</p>
                    </div>

                    <div class="bbtn-group">
                        <input class="bbtn bbtn-radio" id='css3' type="checkbox" name="css3">
                        <label for="css3" class="bbtn-label b-icon-container b-label-css">
                            <i class="b-icon b-icon-css" ></i>
                        </label>
                        <p>CSS3</p>
                    </div>

                    <div class="bbtn-group">
                        <input class="bbtn bbtn-radio" id='js' type="checkbox" name="js">
                        <label for="js" class="bbtn-label b-icon-container b-label-js">
                            <i class="b-icon b-icon-js" ></i>
                        </label>
                        <p>Javascript</p>
                    </div>

                    <div class="bbtn-group">
                        <input class="bbtn bbtn-radio" id='jquery' type="checkbox" name="jquery">
                        <label for="jquery" class="bbtn-label b-icon-container b-label-jquery">
                            <i class="b-icon b-icon-jquery" ></i>
                        </label>
                        <p>jQuery</p>
                    </div>

                    <div class="bbtn-group">
                        <input class="bbtn bbtn-radio" id='less' type="checkbox" name="less">
                        <label for="less" class="bbtn-label b-icon-container b-label-less">
                            <i class="b-icon b-icon-less" ></i>
                        </label>
                        <p>Less</p>
                    </div>

                    <div class="bbtn-group">
                        <input class="bbtn bbtn-radio" id='bootstrap' type="checkbox" name="bootstrap">
                        <label for="bootstrap" class="bbtn-label b-icon-container b-label-bootstrap">
                            <i class="b-icon b-icon-bootstrap" ></i>
                        </label>
                        <p>Bootstrap</p>
                    </div>

                    <div class="bbtn-group">
                        <input class="bbtn bbtn-radio" id='git' type="checkbox" name="git">
                        <label for="git" class="bbtn-label b-icon-container b-label-git">
                            <i class="b-icon b-icon-git" ></i>
                        </label>
                        <p>Git</p>
                    </div>

                </div>

            </div>

        </div>
    </div>

</div>

<div class="toolbars">
    <div class="toolbar-text">
        <div class="btn-group">
            <a class="btn  btn-large dropdown-toggle" data-toggle="dropdown" title="" data-original-title="Font Color"><i class="icon-tint"></i>&nbsp;<b class="caret"></b></a>
            <ul class="dropdown-menu">
                <li> <a class="btn btn-large" command="color #ff0000" title="Use Red Color"><i class="icon-tint"></i> Red</a></li>
                <li> <a class="btn btn-large" command="color #00ff00" title="Use Green Color"><i class="icon-tint"></i> Green</a></li>
                <li> <a class="btn btn-large" command="color #0000ff" title="Use Blue Color"><i class="icon-tint"></i> Blue</a></li>
            </ul>
        </div>
        <div class="btn-group">
            <a class="btn  btn-large dropdown-toggle" data-toggle="dropdown" title="" data-original-title="Font Size"><i class="icon-text-height"></i>&nbsp;<b class="caret"></b></a>
            <ul class="dropdown-menu">
                <li><a command="size 32px"><font size="5">Huge</font></a></li>
                <li><a command="size 20px"><font size="3">Normal</font></a></li>
                <li><a command="size 12px"><font size="1">Small</font></a></li>
            </ul>
        </div>
        <div class="btn-group">
            <a class="btn btn-large"  command="align left" title="Align Left" data-original-title="Align Left (Ctrl/Cmd+L)"><i class="icon-align-left"></i></a>
            <a class="btn btn-large"  command="align center" title="Align Center" data-original-title="Center (Ctrl/Cmd+E)"><i class="icon-align-center"></i></a>
            <a class="btn btn-large"  command="align right" title="Align Right" data-original-title="Align Right (Ctrl/Cmd+R)"><i class="icon-align-right"></i></a>
        </div>
        <div class="btn-group">
            <a class="btn btn-large " data-edit="bold" title="" data-original-title="Bold (Ctrl/Cmd+B)"><i class="icon-bold"></i></a>
            <a class="btn btn-large" data-edit="italic" title="" data-original-title="Italic (Ctrl/Cmd+I)"><i class="icon-italic"></i></a>
            <a class="btn btn-large" data-edit="underline" title="" data-original-title="Underline (Ctrl/Cmd+U)"><i class="icon-underline"></i></a>
        </div>

        <div class="btn-group">
            <a class="btn btn-large" data-edit="insertunorderedlist" title="" data-original-title="Bullet list"><i class="icon-list-ul"></i></a>
            <a class="btn btn-large" data-edit="insertorderedlist" title="" data-original-title="Number list"><i class="icon-list-ol"></i></a>
        </div>
    </div>
</div>
